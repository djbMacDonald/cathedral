"use strict";function MainCtrl(a,b){var c=this;c.things=["1","2","3"],c.points=a.points,c.doStuff=function(){a.iterate(),c.draw()},c.draw=function(){b.d3().then(function(a){var b=c.points,d={top:20,right:20,bottom:30,left:40},e=300-d.left-d.right,f=300-d.top-d.bottom,g=a.scale.linear().range([0,e]),h=a.scale.linear().range([f,0]),i=a.svg.axis().scale(g).orient("bottom"),j=a.svg.axis().scale(h).orient("left"),k=a.svg.line().x(function(a){return g(a.x)}).y(function(a){return h(a.y)});a.select("body").selectAll("svg").remove();var l=a.select("#graph").append("svg").attr("width",e+d.left+d.right).attr("height",f+d.top+d.bottom).append("g").attr("transform","translate("+d.left+","+d.top+")");b.forEach(function(a){a.x=a.x,a.y=+a.y});var m=a.min(b,function(a){return a.x}),n=a.min(b,function(a){return a.y}),o=a.max(b,function(a){return a.x}),p=a.max(b,function(a){return a.y});g.domain([_.min([m,n]),_.max([o,p])]),h.domain([_.min([m,n]),_.max([o,p])]),l.append("path").datum(b).attr("class","line").attr("d",k),l.append("g").attr("class","x axis").attr("transform","translate(0,"+f+")").call(i),l.append("g").attr("class","y axis").call(j).append("text").attr("transform","rotate(-90)").attr("y",6).attr("dy",".71em").style("text-anchor","end")})}}function replacementGraph(a){return{restrict:"EA",templateUrl:"views/partials/replacement.html",controller:"MainCtrl",controllerAs:"main",bindToController:!0}}angular.module("fractalApp",["ngRoute","d3","MainDirective"]),angular.module("fractalApp").config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl",controllerAs:"main"}).otherwise({redirectTo:"/"})}]),angular.module("d3",[]).factory("d3Service",["$document","$q","$rootScope",function(a,b,c){function d(){c.$apply(function(){e.resolve(window.d3)})}var e=b.defer(),f=a[0].createElement("script");f.type="text/javascript",f.async=!0,f.src="bower_components/d3/d3.js",f.onreadystatechange=function(){"complete"===this.readyState&&d()},f.onload=d;var g=a[0].getElementsByTagName("body")[0];return g.appendChild(f),{d3:function(){return e.promise}}}]),angular.module("fractalApp").factory("GraphFactory",[function(){var a=[{x:0,y:0},{x:1,y:0},{x:2,y:1},{x:3,y:0},{x:4,y:0}],b=[];b.push(a),b=_.flatten(b);var c=function(){for(var c=[],i=0;i<b.length-1;i++){var j=d(b[i],b[i+1]),k=e(a,j),l=f(b[i],b[i+1]);k=g(k,l),k=h(k,b[i]),c.push(k)}c=_.flatten(c),angular.copy(c,b)},d=function(a,b){var c=Math.abs(a.x-b.x),d=Math.abs(a.y-b.y);return Math.sqrt(Math.pow(c,2)+Math.pow(d,2))},e=function(a,b){return a.map(function(a){return{x:a.x*b,y:a.y*b}})},f=function(a,b){var c=b.x-a.x,d=b.y-a.y;return Math.atan(d/c)},g=function(a,b){var c=[[Math.cos(b),-Math.sin(b)],[Math.sin(b),Math.cos(b)]];return a.map(function(a){return i(c,a)})},h=function(a,b){return a.map(function(a){return{x:a.x+b.x,y:a.y+b.y}})},i=function(a,b){var c=a[0][0]*b.x+a[0][1]*b.y,d=a[1][0]*b.x+a[1][1]*b.y;return{x:c,y:d}};return{points:b,iterate:c}}]),angular.module("fractalApp").controller("MainCtrl",MainCtrl),MainCtrl.$inject=["GraphFactory","d3Service"],angular.module("MainDirective",[]),angular.module("MainDirective").directive("replacementGraph",["d3Service",replacementGraph]);