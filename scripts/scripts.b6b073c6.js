"use strict";function MainCtrl(a){var b=this;b.things=["1","2","3"],b.points=a.points,b.doStuff=function(){console.log("stuff"),a.iterate()}}function replacementGraph(a){return{restrict:"EA",templateUrl:"views/partials/replacement.html",controller:"MainCtrl",controllerAs:"main",bindToController:!0,scope:{main:"@"},link:function(b,c,d){a.d3().then(function(a){var d=b.main.points,e={top:20,right:20,bottom:20,left:20},f=300-e.left-e.right,g=300-e.top-e.bottom,h=a.scale.linear().range([0,f]),i=a.scale.linear().range([g,0]),j=a.svg.line().x(function(a){return h(a.x)}).y(function(a){return i(a.y)}),k=a.select(c[0]).append("svg").attr("width",f+e.left+e.right).attr("height",g+e.top+e.bottom).append("g").attr("transform","translate("+e.left+","+e.top+")");d.forEach(function(a){a.x=a.x,a.y=+a.y}),h.domain(a.extent(d,function(a){return a.x})),i.domain(a.extent(d,function(a){return a.y})),k.append("path").datum(d).attr("class","line").attr("d",j),console.log(b.main.points)})}}}angular.module("fractalApp",["ngRoute","d3","MainDirective"]),angular.module("fractalApp").config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl",controllerAs:"main"}).otherwise({redirectTo:"/"})}]),angular.module("d3",[]).factory("d3Service",["$document","$q","$rootScope",function(a,b,c){function d(){c.$apply(function(){e.resolve(window.d3)})}var e=b.defer(),f=a[0].createElement("script");f.type="text/javascript",f.async=!0,f.src="bower_components/d3/d3.js",f.onreadystatechange=function(){"complete"===this.readyState&&d()},f.onload=d;var g=a[0].getElementsByTagName("body")[0];return g.appendChild(f),{d3:function(){return e.promise}}}]),angular.module("fractalApp").factory("GraphFactory",[function(){var a=[{x:1,y:2},{x:5,y:5},{x:0,y:0}],b=a,c=function(){for(var c=[],i=0;i<b.length-1;i++){var j=d(b[i],b[i+1]),k=e(a,j),l=f(b[i],b[i+1]);k=g(k,l),k=h(k,b[i]),c.push(k)}c=_.flatten(c),angular.copy(c,b)},d=function(a,b){var c=Math.abs(a.x-b.x),d=Math.abs(a.y-b.y);return Math.sqrt(Math.pow(c,2)+Math.pow(d,2))},e=function(a,b){return a.map(function(a){return{x:a.x*b,y:a.y*b}})},f=function(a,b){var c=Math.abs(a.x-b.x),d=Math.abs(a.y-b.y);return Math.tan(d/c)},g=function(a,b){var c=[[Math.cos(b),-Math.sin(b)],[Math.sin(b),Math.cos(b)]];return a.map(function(a){return i(c,a)})},h=function(a,b){return a.map(function(a){return{x:a.x+b.x,y:a.y+b.y}})},i=function(a,b){var c=a[0][0]*b.x+a[0][1]*b.y,d=a[1][0]*b.x+a[1][1]*b.y;return{x:c,y:d}};return{points:b,iterate:c}}]),angular.module("fractalApp").controller("MainCtrl",MainCtrl),MainCtrl.$inject=["GraphFactory"],angular.module("MainDirective",[]),angular.module("MainDirective").directive("replacementGraph",["d3Service",replacementGraph]);